# Victor Base C# Binding & SDK - INDEV Beta Final 1.0.10

## Descripci칩n / Description

- **Espa침ol:**  
  VictorLib es el SDK de interoperabilidad en C# para la librer칤a nativa Victor Base. Permite acceso eficiente a funcionalidades de indexaci칩n, b칰squeda y gesti칩n de vectores, con una API moderna y segura para .NET.

- **English:**  
  VictorLib is the C# interoperability SDK for the native Victor Base library. It provides efficient access to indexing, search, and vector management features, with a modern and safe API for .NET.

---

## Estructura del proyecto / Project Structure

```
Src/
  Common/
    Mapping.cs
    Structs.cs
  InterOp/
    Factory/
      Factory.cs
    Native/
      INativeMethods.cs
      NativeMethodsLinux.cs
      NativeMethodsWindows.cs
      StaticNativeLinux.cs
      StaticNativeWindows.cs
    VictorExceptions/
      VictorExceptions.cs
    VictorSDK/
      VictorLib.cs
      VictorSDK_Index.cs
      VictorSDKAsort.cs
Tests/
  UnitTest1.cs
Examples/
  (usage examples)
```

- **Espa침ol:**  
  - `InterOp` contiene **VictorSDK**, la capa de abstracci칩n sobre las funciones nativas.
  - `Common` incluye estructuras y utilidades reutilizables.
  - `Tests` contiene pruebas unitarias y de integraci칩n.
  - `Examples` incluye ejemplos pr치cticos de uso.

- **English:**  
  - `InterOp` contains **VictorSDK**, the abstraction layer over native functions.
  - `Common` includes reusable structs and utilities.
  - `Tests` contains unit and integration tests.
  - `Examples` provides practical usage examples.

---

## M칠todos principales / Main Methods

- **Insert:**  
  - **Espa침ol:** Inserta un vector en el 칤ndice con un ID 칰nico.  
  - **English:** Adds a vector to the index using a unique ID.

- **Search:**  
  - **Espa침ol:** Busca el vector m치s cercano en el 칤ndice.  
  - **English:** Searches for the closest vector in the index.

- **Search_n:**  
  - **Espa침ol:** Devuelve los N vectores m치s cercanos.  
  - **English:** Returns the N closest vectors.

- **Delete:**  
  - **Espa침ol:** Elimina un vector por su ID.  
  - **English:** Deletes a vector by its ID.

- **GetSize:**  
  - **Espa침ol:** Obtiene el n칰mero total de vectores en el 칤ndice.  
  - **English:** Gets the total number of vectors in the index.

- **DumpIndex:**  
  - **Espa침ol:** Guarda el estado actual del 칤ndice en un archivo.  
  - **English:** Saves the current index state to a file.

- **LoadIndex:**  
  - **Espa침ol:** Carga un 칤ndice desde un archivo.  
  - **English:** Loads an index from a file.

- **Dispose:**  
  - **Espa침ol:** Libera recursos y evita fugas de memoria.  
  - **English:** Releases resources and prevents memory leaks.

- **GetStats:**  
  - **Espa침ol:** Obtiene estad칤sticas detalladas del 칤ndice (operaciones, tiempos, etc).  
  - **English:** Gets detailed index statistics (operations, timings, etc).

- **SetBasePath**
  - **Espa침ol:** Te permite setear una ruta custom para guardar tus archivos json de 칤ndices.
  - **English:** Allows you to set a custom file path to save your index json files.

- **DumpToAutoPath**
  - **Espa침ol:** Guarda el/los 칤ndices en un json generado en una carpeta llamada ".victorIndex"(generalmente en la carpeta bin/Debug) de manera autom치tica si no le proporcion치s una ruta custom.
  - **English:** Automatically saves the index/indices in a JSON file generated in a folder named ".victorIndex" (normally in bin/Debug) if you don't provide a custom path.

---

## Instalaci칩n / Installation

### Espa침ol

Para instalar la librer칤a desde NuGet:

```bash
dotnet add package VictorLib --prerelease
```

### English

To install the library from NuGet:

```bash
dotnet add package VictorLib --prerelease
```

---

## Ejemplo de uso b치sico/Minimal Usage Example

### Espa침ol

```csharp

// Pista: El ctor VictorSDK implementa IDisposable, por lo tanto podemos evitar el metodo Dispose() con using cada vez que inicialicemos el ctor.
VictorSDK sdk = new(type: IndexType.FLAT, method: DistanceMethod.DOTPROD, dims: 128);

// Insertar un vector
sdk.Insert(id: 1,vector: new float[128],dims: 128);

// Buscar un vector
var result = sdk.Search(new float[128], 128);
Console.WriteLine($"Match ID: {result.Label}, Distance: {result.Distance}");

// Obtener el tama침o del 칤ndice
ulong size = sdk.GetSize();
Console.WriteLine($"Index size: {size}");

// Guardar el 칤ndice en un archivo
sdk.DumpIndex("index_dump.dat");

// Liberar recursos manualmente.
sdk.Dispose();
```

### English

```csharp
//Hint: VictorSDK implements IDisposable, so you can avoid Dispose() with using to free resources.
VictorSDK sdk = new (type: IndexType.FLAT, method: DistanceMethod.DOTPROD, dims: 128);

// Insert a vector
sdk.Insert(1, new float[128], 128);

// Search for a vector
var result = sdk.Search(new float[128], 128);
Console.WriteLine($"Match ID: {result.Label}, Distance: {result.Distance}");

// Get the size of the index
ulong size = sdk.GetSize();
Console.WriteLine($"Index size: {size}");

// Save the index to a file
sdk.DumpIndex("index_dump.dat");

// Release resources manually
sdk.Dispose();
```

---

## Notas importantes / Important Notes

- **Contextos:**  
  - Para 칤ndices tipo `HNSW` o `NSW`, debes pasar un contexto v치lido al constructor.  
  - Para 칤ndices tipo `FLAT`, el contexto es ignorado y puede ser `null`.

- **Logging y Diagn칩stico:**  
  - El SDK utiliza `Debug.WriteLine` para mensajes de depuraci칩n.  
  - No se imprimen mensajes en consola a menos que el usuario lo haga expl칤citamente.

- **Compatibilidad:**  
  - Compatible con Windows y Linux (x64).
  - Requiere la biblioteca nativa Victor Base instalada y accesible en el sistema.

- **DevX:**
  - M치s abajo te cuento c칩mo recomiendo usar los m칠todos en un ejemplo m치s detallado aprovechando mejor la potencia de la lib. Consultar: "Buenas pr치cticas / Good coding".
  - Below you will find a more detailed example showing how to make the most of the library's features. See: "Good coding" for best practices.

---

## Notas sobre tipos de 칤ndices y m칠todos de b칰squeda / Notes on Index Types and Search Methods

### Tipos de 칤ndice / Index Types

- **FLAT:**  
  - No requiere contexto, pero puedes pasar `null` para el par치metro `context` en el constructor.
  - Uso recomendado para 칤ndices peque침os o cuando no necesitas estructuras jer치rquicas.

- **HNSW / NSW:**  
  - Permiten y suelen requerir un contexto (`HNSWContext` o `NSWContext`) para configurar par치metros avanzados.
  - Si pasas `null`, se usar치n valores por defecto.
  - Uso recomendado para grandes vol칰menes de datos y b칰squedas r치pidas.

**Nota:**  

- Todos los tipos de 칤ndice aceptan `null` como contexto en el constructor.  
- El contexto solo es obligatorio para `HNSW` y `NSW` si quieres personalizar par치metros.

### M칠tricas de distancia / Distance Metrics

- **cosine:**  
  - Mide la similitud angular entre dos vectores.
  - 칔til para comparar orientaci칩n m치s que magnitud (por ejemplo, embeddings de texto).

- **euclidian:**  
  - Calcula la distancia euclidiana est치ndar.
  - 칔til para datos donde la magnitud importa.

- **dotproduct:**  
  - Calcula el producto punto entre dos vectores.
  - 칔til para tareas de ranking y algunas aplicaciones de machine learning.

### M칠todos de b칰squeda / Search Methods

- **Search:**  
  - Devuelve el vector m치s cercano al vector de consulta.
  - Uso general para obtener el mejor match.

- **Search_n:**  
  - Devuelve los N vectores m치s cercanos.
  - 칔til para recomendaciones, clustering, o an치lisis de vecinos.

- **Contains:**  
  - Verifica si uno o m치s IDs existen en el 칤ndice.

- **Delete:**  
  - Elimina un vector por su ID.

### Ejemplo de inicializaci칩n con y sin contexto

```csharp
// FLAT index 
var flatSdk = new VictorSDK(type: IndexType.FLAT, method: DistanceMethod.DOTPROD, dims: 128, context: null);

// HNSW index 
var hnswContext = HNSWContext.Create(efConstruct: 200, efSearch: 100, m0: 32);
VictorSDK hnswSdk = new (type: IndexType.HNSW, method: DistanceMethod.COSINE, dims: 128, context: hnswContext);

// HNSW index 
VictorSDK hnswDefaultSdk = new (type: IndexType.HNSW, method: DistanceMethod.COSINE, dims: 128, context: null);

```

---

## Notes on Index Types and Search Methods

### Index Types

- **FLAT:**  
  - Does not require a context, but you can pass `null` for the `context` parameter in the constructor.
  - Recommended for small indices or when you do not need hierarchical structures.

- **HNSW / NSW:**  
  - Allow and usually require a context (`HNSWContext` or `NSWContext`) to configure advanced parameters.
  - If you pass `null`, default values will be used.
  - Recommended for large datasets and fast searches.

### Distance Metrics

- **cosine:**  
  - Measures the angular similarity between two vectors.
  - Useful for comparing orientation rather than magnitude (e.g., text embeddings).

- **euclidian:**  
  - Computes the standard Euclidean distance.
  - Useful when magnitude matters.

- **dotproduct:**  
  - Computes the dot product between two vectors.
  - Useful for ranking tasks and some machine learning applications.

**Note:**  

- All index types accept `null` as the context in the constructor.  
- The context is only required for `HNSW` and `NSW` if you want to customize parameters.

### Search Methods

- **Search:**  
  - Returns the closest vector to the query vector.
  - General use for obtaining the best match.

- **Search_n:**  
  - Returns the N closest vectors.
  - Useful for recommendations, clustering, or neighbor analysis.

- **Contains:**  
  - Checks if one or more IDs exist in the index.

- **Delete:**  
  - Deletes a vector by its ID.

### Example: Initialization With and Without Context

```csharp
// FLAT index (context can be null)
var flatSdk = new VictorSDK(type: IndexType.FLAT, method: DistanceMethod.DOTPROD, dims: 128, context: null);

// HNSW index (with custom context)
var hnswContext = HNSWContext.Create(efConstruct: 200, efSearch: 100, m0: 32);
VictorSDK hnswSdk = new (type: IndexType.HNSW, method: DistanceMethod.COSINE, dims: 128, context: hnswContext);

// HNSW index 
VictorSDK hnswDefaultSdk = new (type: IndexType.HNSW, method: DistanceMethod.COSINE, dims: 128, context: null);
```

---

## Buenas pr치cticas / Good coding

- Un peque침o archivo de docs adicional donde te muestro c칩mo recomiendo usar las funciones de persistencia, y un patr칩n de dise침o que recomiendo mientras uses la librer칤a.

[游닀 Recomendado: Patr칩n Double Using + Persistencia JSON (Espa침ol)](./RECOMENDEDESP.MD)

- A little file where i show you how to use the Json persistence methods & a design pattern

[游닀 Recommended: Double Using + JSON Persistence Pattern (English)](./RECOMENDEDENG.md)

---

## Contribuciones / Contributions

### Espa침ol

Las contribuciones son bienvenidas. Por favor, abr칤 un issue o un pull request siguiendo este formato:

```bash
git checkout -b feature/nombre-del-issue
```

### English

Contributions are welcome. Please open an issue or pull request using this format:

```bash
git checkout -b feature/issue-name
```

---

## Cr칠ditos y Licencia / Credits & License

- **Espa침ol:**  
  Este SDK complementa Victor Base <https://github.com/victor-base>, un proyecto de Emiliano A. Billi.  
  SDK desarrollado por Iv치n E. Rodr칤guez bajo licencia LGPL-3.0.

- **English:**  
  This SDK complements Victor Base <https://github.com/victor-base>, a project by Emiliano A. Billi.  
  SDK developed by Iv치n E. Rodr칤guez under LGPL-3.0 license.

---

## Soporte / Support

- Para consultas t칠cnicas: <ivanrwcm25@gmail.com>  
- M치s informaci칩n sobre el desarrollador: <https://ivanrodportolio.netlify.app/>
